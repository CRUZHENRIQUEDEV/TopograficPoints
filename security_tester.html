<!-- Vers√£o: 1.0 -->
<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Testador de Seguran√ßa de APIs</title>
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/themes.css" />
    <link rel="stylesheet" href="css/responsive.css" />
    <style>
      body {
        background-color: var(--bg-primary);
        color: var(--text-primary);
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 20px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: var(--bg-secondary);
        border-radius: 10px;
        padding: 20px;
        border: 1px solid var(--border-color);
      }

      .warning-box {
        background: linear-gradient(135deg, #ff6b35, #f7931e);
        color: white;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
        text-align: center;
      }

      .warning-box h3 {
        margin: 0 0 10px 0;
        color: white;
      }

      .form-section {
        background: var(--bg-tertiary);
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
        border: 1px solid var(--border-color);
      }

      .form-group {
        margin-bottom: 15px;
      }

      .form-label {
        display: block;
        font-weight: 600;
        color: var(--primary-color);
        margin-bottom: 5px;
      }

      .form-input {
        width: 100%;
        padding: 10px;
        border: 1px solid var(--border-color);
        border-radius: 5px;
        background: var(--bg-secondary);
        color: var(--text-primary);
        font-size: 14px;
        box-sizing: border-box;
      }

      .form-input:focus {
        outline: none;
        border-color: var(--primary-color);
      }

      .endpoints-section {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 20px;
      }

      .endpoints-list {
        background: var(--bg-tertiary);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 15px;
        max-height: 300px;
        overflow-y: auto;
      }

      .endpoints-list h4 {
        margin: 0 0 15px 0;
        color: var(--primary-color);
      }

      .endpoint-item {
        display: flex;
        align-items: center;
        margin-bottom: 8px;
        padding: 5px;
        border-radius: 4px;
        transition: background 0.2s;
      }

      .endpoint-item:hover {
        background: var(--bg-secondary);
      }

      .endpoint-item input[type="checkbox"] {
        margin-right: 8px;
      }

      .endpoint-item label {
        font-size: 12px;
        font-family: monospace;
        cursor: pointer;
        flex: 1;
      }

      .controls {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .btn {
        background: var(--primary-color);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: 500;
        transition: background 0.2s;
      }

      .btn:hover {
        background: var(--success-color);
      }

      .btn:disabled {
        background: var(--secondary-color);
        cursor: not-allowed;
        opacity: 0.6;
      }

      .btn-danger {
        background: var(--danger-color);
      }

      .btn-danger:hover {
        background: #c82333;
      }

      .delay-control {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .delay-control input {
        width: 80px;
        padding: 5px;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        background: var(--bg-secondary);
        color: var(--text-primary);
        text-align: center;
      }

      .progress-bar {
        width: 100%;
        height: 20px;
        background: var(--bg-tertiary);
        border-radius: 10px;
        overflow: hidden;
        margin-bottom: 20px;
        border: 1px solid var(--border-color);
      }

      .progress-fill {
        height: 100%;
        background: var(--primary-color);
        width: 0%;
        transition: width 0.3s;
      }

      .results-section {
        background: var(--bg-tertiary);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 15px;
      }

      .results-tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 15px;
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 10px;
      }

      .tab-btn {
        background: transparent;
        border: 1px solid var(--border-color);
        color: var(--text-primary);
        padding: 8px 16px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 12px;
      }

      .tab-btn.active {
        background: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
      }

      .results-content {
        max-height: 400px;
        overflow-y: auto;
      }

      .result-item {
        display: flex;
        align-items: center;
        padding: 8px;
        border-bottom: 1px solid var(--border-light);
        font-size: 12px;
        font-family: monospace;
      }

      .status-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 8px;
        flex-shrink: 0;
      }

      .status-200 {
        background: #28a745;
      }
      .status-400 {
        background: #ffc107;
      }
      .status-401 {
        background: #fd7e14;
      }
      .status-403 {
        background: #dc3545;
      }
      .status-404 {
        background: #6c757d;
      }
      .status-500 {
        background: #dc3545;
      }
      .status-error {
        background: #6f42c1;
      }

      .result-url {
        flex: 1;
        margin-right: 10px;
        word-break: break-all;
      }

      .result-status {
        font-weight: bold;
        min-width: 60px;
      }

      .result-time {
        min-width: 60px;
        text-align: right;
        opacity: 0.7;
      }

      .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 10px;
        margin-bottom: 15px;
      }

      .stat-item {
        background: var(--bg-secondary);
        padding: 10px;
        border-radius: 5px;
        text-align: center;
        border: 1px solid var(--border-color);
      }

      .stat-number {
        font-size: 18px;
        font-weight: bold;
        color: var(--primary-color);
      }

      .stat-label {
        font-size: 10px;
        color: var(--text-secondary);
        margin-top: 2px;
      }

      .hidden {
        display: none !important;
      }

      @media (max-width: 768px) {
        .endpoints-section {
          grid-template-columns: 1fr;
        }

        .controls {
          flex-direction: column;
          align-items: stretch;
        }

        .btn {
          width: 100%;
          margin-bottom: 10px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Seletor de Tema -->
    <div class="theme-selector">
      <label for="themeSelect">Tema:</label>
      <select id="themeSelect">
        <option value="default">Padr√£o</option>
        <option value="dark" selected>Escuro</option>
        <option value="corporate">Corporativo</option>
        <option value="green">Verde</option>
        <option value="high-contrast">Alto Contraste</option>
        <option value="minimal">Minimalista</option>
        <option value="purple-tech">Roxo Tech</option>
      </select>
    </div>

    <div class="container">
      <h1>üõ°Ô∏è Testador de Seguran√ßa de APIs</h1>

      <div class="warning-box">
        <h3>‚ö†Ô∏è AVISO IMPORTANTE</h3>
        <p>
          <strong
            >Esta ferramenta deve ser usada APENAS em seus pr√≥prios
            sistemas!</strong
          >
        </p>
        <p>
          Testar sistemas de terceiros sem autoriza√ß√£o √© ilegal e pode violar
          leis de crimes cibern√©ticos.
        </p>
        <p>
          Use com responsabilidade e apenas para avaliar a seguran√ßa dos seus
          pr√≥prios servi√ßos.
        </p>
      </div>

      <div class="form-section">
        <div class="form-group">
          <label class="form-label">üåê URL Base do Sistema</label>
          <input
            type="text"
            class="form-input"
            id="baseUrl"
            placeholder="https://meusite.com/api/v1/"
            value="https://httpbin.org/"
          />
          <small style="color: var(--text-secondary); font-size: 11px">
            Digite a URL base do SEU sistema que voc√™ quer testar
          </small>
        </div>

        <div class="form-group">
          <label class="form-label">üìù Palavras Customizadas</label>
          <textarea
            class="form-input"
            id="customEndpoints"
            placeholder="Insira palavras separadas por v√≠rgula: exemplo, teste, admin, config, users, profile, dados, estruturas, pontes, api/v2, backup-2024"
            rows="3"
            style="resize: vertical; font-family: monospace; font-size: 12px"
          ></textarea>
          <small style="color: var(--text-secondary); font-size: 11px">
            Separe cada palavra/endpoint com v√≠rgula. Espa√ßos ser√£o removidos
            automaticamente.
          </small>
        </div>

        <div class="form-group">
          <label class="form-label">üîß Configura√ß√µes</label>
          <div class="delay-control">
            <label>Delay entre requisi√ß√µes:</label>
            <input type="number" id="delayMs" value="100" min="50" max="5000" />
            <span>ms</span>
          </div>
        </div>
      </div>

      <div class="endpoints-section">
        <div class="endpoints-list">
          <h4>üóÇÔ∏è Endpoints Comuns</h4>
          <div id="commonEndpoints"></div>
        </div>

        <div class="endpoints-list">
          <h4>üîí Endpoints de Seguran√ßa</h4>
          <div id="securityEndpoints"></div>
        </div>
      </div>

      <div class="endpoints-section">
        <div class="endpoints-list" style="grid-column: 1 / -1">
          <h4>üìù Suas Palavras Customizadas</h4>
          <div
            id="customEndpointsDisplay"
            style="
              color: var(--text-secondary);
              font-size: 12px;
              font-style: italic;
            "
          >
            Digite palavras no campo acima para v√™-las listadas aqui
          </div>
        </div>
      </div>

      <div class="controls">
        <button class="btn" id="startTest">üöÄ Iniciar Teste</button>
        <button class="btn btn-danger" id="stopTest" disabled>‚èπÔ∏è Parar</button>
        <button class="btn" id="selectAll">‚òëÔ∏è Selecionar Todos</button>
        <button class="btn" id="selectNone">‚òê Limpar Sele√ß√£o</button>
        <button class="btn" id="exportResults" disabled>üì• Exportar</button>
      </div>

      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div
        style="
          text-align: center;
          margin-bottom: 20px;
          font-size: 12px;
          color: var(--text-secondary);
        "
        id="progressText"
      >
        Pronto para iniciar
      </div>

      <div class="results-section">
        <div class="stats" id="statsSection">
          <div class="stat-item">
            <div class="stat-number" id="totalRequests">0</div>
            <div class="stat-label">Total</div>
          </div>
          <div class="stat-item">
            <div class="stat-number" id="successRequests">0</div>
            <div class="stat-label">Sucessos</div>
          </div>
          <div class="stat-item">
            <div class="stat-number" id="errorRequests">0</div>
            <div class="stat-label">Erros</div>
          </div>
          <div class="stat-item">
            <div class="stat-number" id="vulnerableEndpoints">0</div>
            <div class="stat-label">Vulner√°veis</div>
          </div>
        </div>

        <div class="results-tabs">
          <button class="tab-btn active" data-tab="all">Todos</button>
          <button class="tab-btn" data-tab="success">Sucessos</button>
          <button class="tab-btn" data-tab="errors">Erros</button>
          <button class="tab-btn" data-tab="vulnerable">Vulner√°veis</button>
        </div>

        <div class="results-content" id="resultsContent">
          <div
            style="
              text-align: center;
              padding: 40px;
              color: var(--text-secondary);
            "
          >
            Nenhum teste executado ainda
          </div>
        </div>
      </div>
    </div>

    <script>
      class SecurityTester {
        constructor() {
          this.isRunning = false;
          this.results = [];
          this.currentIndex = 0;
          this.selectedEndpoints = [];
          this.activeTab = "all";

          this.commonEndpoints = [
            "status",
            "health",
            "version",
            "info",
            "ping",
            "users",
            "login",
            "register",
            "profile",
            "settings",
            "admin",
            "dashboard",
            "api",
            "docs",
            "swagger",
            "test",
            "debug",
            "config",
            "backup",
            "logs",
            "upload",
            "download",
            "files",
            "images",
            "media",
            "search",
            "filter",
            "export",
            "import",
            "sync",
          ];

          this.securityEndpoints = [
            ".env",
            ".git/config",
            "robots.txt",
            "sitemap.xml",
            "admin/login",
            "wp-admin",
            "phpmyadmin",
            "database",
            "server-status",
            "server-info",
            ".htaccess",
            "web.config",
            "crossdomain.xml",
            "clientaccesspolicy.xml",
            "traces.axd",
            "trace.axd",
            "elmah.axd",
            "console",
            "shell",
            "cmd",
            "terminal",
            "backup.sql",
            "dump.sql",
            "database.sql",
            "config.php",
            "config.json",
            "settings.ini",
          ];

          this.init();
        }

        init() {
          this.initElements();
          this.initEventListeners();
          this.initTheme();
          this.populateEndpoints();
        }

        initElements() {
          this.baseUrlInput = document.getElementById("baseUrl");
          this.delayInput = document.getElementById("delayMs");
          this.customEndpointsInput =
            document.getElementById("customEndpoints");
          this.customEndpointsDisplay = document.getElementById(
            "customEndpointsDisplay"
          );
          this.startBtn = document.getElementById("startTest");
          this.stopBtn = document.getElementById("stopTest");
          this.selectAllBtn = document.getElementById("selectAll");
          this.selectNoneBtn = document.getElementById("selectNone");
          this.exportBtn = document.getElementById("exportResults");
          this.progressFill = document.getElementById("progressFill");
          this.progressText = document.getElementById("progressText");
          this.resultsContent = document.getElementById("resultsContent");

          // Stats
          this.totalRequests = document.getElementById("totalRequests");
          this.successRequests = document.getElementById("successRequests");
          this.errorRequests = document.getElementById("errorRequests");
          this.vulnerableEndpoints = document.getElementById(
            "vulnerableEndpoints"
          );
        }

        initEventListeners() {
          this.startBtn.addEventListener("click", () => this.startTest());
          this.stopBtn.addEventListener("click", () => this.stopTest());
          this.selectAllBtn.addEventListener("click", () =>
            this.selectAllEndpoints()
          );
          this.selectNoneBtn.addEventListener("click", () =>
            this.selectNoneEndpoints()
          );
          this.exportBtn.addEventListener("click", () => this.exportResults());

          // Custom endpoints
          this.customEndpointsInput.addEventListener("input", () =>
            this.updateCustomEndpointsDisplay()
          );

          // Tabs
          document.querySelectorAll(".tab-btn").forEach((btn) => {
            btn.addEventListener("click", (e) => {
              this.activeTab = e.target.dataset.tab;
              this.updateTabsUI();
              this.displayResults();
            });
          });
        }

        initTheme() {
          const themeSelect = document.getElementById("themeSelect");
          const savedTheme =
            localStorage.getItem("security-tester-theme") || "dark";

          if (savedTheme !== "default") {
            document.documentElement.setAttribute("data-theme", savedTheme);
          }
          themeSelect.value = savedTheme;

          themeSelect.addEventListener("change", (e) => {
            const theme = e.target.value;
            if (theme === "default") {
              document.documentElement.removeAttribute("data-theme");
            } else {
              document.documentElement.setAttribute("data-theme", theme);
            }
            localStorage.setItem("security-tester-theme", theme);
          });
        }

        populateEndpoints() {
          const commonContainer = document.getElementById("commonEndpoints");
          const securityContainer =
            document.getElementById("securityEndpoints");

          this.commonEndpoints.forEach((endpoint) => {
            const div = document.createElement("div");
            div.className = "endpoint-item";
            div.innerHTML = `
                        <input type="checkbox" id="common_${endpoint}" value="${endpoint}">
                        <label for="common_${endpoint}">${endpoint}</label>
                    `;
            commonContainer.appendChild(div);
          });

          this.securityEndpoints.forEach((endpoint) => {
            const div = document.createElement("div");
            div.className = "endpoint-item";
            div.innerHTML = `
                        <input type="checkbox" id="security_${endpoint.replace(
                          /[^a-zA-Z0-9]/g,
                          "_"
                        )}" value="${endpoint}">
                        <label for="security_${endpoint.replace(
                          /[^a-zA-Z0-9]/g,
                          "_"
                        )}">${endpoint}</label>
                    `;
            securityContainer.appendChild(div);
          });
        }

        selectAllEndpoints() {
          document.querySelectorAll('input[type="checkbox"]').forEach((cb) => {
            cb.checked = true;
          });
        }

        selectNoneEndpoints() {
          document.querySelectorAll('input[type="checkbox"]').forEach((cb) => {
            cb.checked = false;
          });
        }

        parseCustomEndpoints() {
          const text = this.customEndpointsInput.value.trim();
          if (!text) return [];

          return text
            .split(",")
            .map((word) => word.trim())
            .filter((word) => word.length > 0)
            .filter((word, index, array) => array.indexOf(word) === index); // Remove duplicates
        }

        updateCustomEndpointsDisplay() {
          const customWords = this.parseCustomEndpoints();

          if (customWords.length === 0) {
            this.customEndpointsDisplay.innerHTML = `
                        <div style="color: var(--text-secondary); font-size: 12px; font-style: italic;">
                            Digite palavras no campo acima para v√™-las listadas aqui
                        </div>
                    `;
            return;
          }

          this.customEndpointsDisplay.innerHTML = `
                    <div style="margin-bottom: 10px; color: var(--primary-color); font-weight: 600; font-size: 12px;">
                        ${customWords.length} palavra(s) personalizada(s):
                    </div>
                    ${customWords
                      .map(
                        (word) => `
                        <div class="endpoint-item">
                            <span style="color: var(--success-color); margin-right: 8px;">‚úì</span>
                            <span style="font-family: monospace; font-size: 12px;">${word}</span>
                        </div>
                    `
                      )
                      .join("")}
                `;
        }

        getSelectedEndpoints() {
          const selected = [];

          // Endpoints das checkboxes
          document
            .querySelectorAll('input[type="checkbox"]:checked')
            .forEach((cb) => {
              selected.push(cb.value);
            });

          // Palavras customizadas
          const customWords = this.parseCustomEndpoints();
          selected.push(...customWords);

          return selected;
        }

        async startTest() {
          const baseUrl = this.baseUrlInput.value.trim();
          if (!baseUrl) {
            alert("Por favor, insira uma URL base v√°lida");
            return;
          }

          this.selectedEndpoints = this.getSelectedEndpoints();
          if (this.selectedEndpoints.length === 0) {
            alert("Por favor, selecione pelo menos um endpoint para testar");
            return;
          }

          this.isRunning = true;
          this.currentIndex = 0;
          this.results = [];
          this.updateUI();
          this.resetStats();

          const delay = parseInt(this.delayInput.value) || 100;

          for (
            let i = 0;
            i < this.selectedEndpoints.length && this.isRunning;
            i++
          ) {
            this.currentIndex = i;
            const endpoint = this.selectedEndpoints[i];
            const url = this.buildUrl(baseUrl, endpoint);

            this.updateProgress();
            await this.testEndpoint(url, endpoint);

            if (i < this.selectedEndpoints.length - 1 && this.isRunning) {
              await this.sleep(delay);
            }
          }

          this.finishTest();
        }

        buildUrl(baseUrl, endpoint) {
          const base = baseUrl.endsWith("/") ? baseUrl : baseUrl + "/";
          return base + endpoint;
        }

        async testEndpoint(url, endpoint) {
          const startTime = performance.now();

          try {
            const response = await fetch(url, {
              method: "GET",
              mode: "cors",
              cache: "no-cache",
              headers: {
                "User-Agent": "Security-Tester/1.0",
              },
            });

            const endTime = performance.now();
            const responseTime = Math.round(endTime - startTime);

            const result = {
              url,
              endpoint,
              status: response.status,
              statusText: response.statusText,
              responseTime,
              timestamp: new Date(),
              isVulnerable: this.checkVulnerability(response, endpoint),
            };

            this.results.push(result);
            this.updateStats(result);
            this.displayResults();
          } catch (error) {
            const endTime = performance.now();
            const responseTime = Math.round(endTime - startTime);

            const result = {
              url,
              endpoint,
              status: "ERROR",
              statusText: error.message,
              responseTime,
              timestamp: new Date(),
              isVulnerable: false,
            };

            this.results.push(result);
            this.updateStats(result);
            this.displayResults();
          }
        }

        checkVulnerability(response, endpoint) {
          // Crit√©rios b√°sicos para identificar poss√≠veis vulnerabilidades
          if (response.status === 200) {
            // Endpoints que n√£o deveriam estar acess√≠veis
            const sensitiveEndpoints = [
              ".env",
              ".git",
              "admin",
              "phpmyadmin",
              "database",
              "config",
              "backup",
              "logs",
              "debug",
              "server-status",
            ];

            return sensitiveEndpoints.some((se) => endpoint.includes(se));
          }

          // Status codes que podem indicar problemas
          return (
            [403, 401].includes(response.status) &&
            ["admin", "login", "dashboard"].some((se) => endpoint.includes(se))
          );
        }

        updateProgress() {
          const progress =
            ((this.currentIndex + 1) / this.selectedEndpoints.length) * 100;
          this.progressFill.style.width = `${progress}%`;
          this.progressText.textContent = `Testando ${
            this.currentIndex + 1
          } de ${this.selectedEndpoints.length}`;
        }

        updateStats(result) {
          this.totalRequests.textContent = this.results.length;

          const successes = this.results.filter(
            (r) => r.status >= 200 && r.status < 400
          ).length;
          this.successRequests.textContent = successes;

          const errors = this.results.filter(
            (r) => r.status >= 400 || r.status === "ERROR"
          ).length;
          this.errorRequests.textContent = errors;

          const vulnerables = this.results.filter((r) => r.isVulnerable).length;
          this.vulnerableEndpoints.textContent = vulnerables;
        }

        resetStats() {
          this.totalRequests.textContent = "0";
          this.successRequests.textContent = "0";
          this.errorRequests.textContent = "0";
          this.vulnerableEndpoints.textContent = "0";
        }

        displayResults() {
          let filteredResults = [...this.results];

          switch (this.activeTab) {
            case "success":
              filteredResults = this.results.filter(
                (r) => r.status >= 200 && r.status < 400
              );
              break;
            case "errors":
              filteredResults = this.results.filter(
                (r) => r.status >= 400 || r.status === "ERROR"
              );
              break;
            case "vulnerable":
              filteredResults = this.results.filter((r) => r.isVulnerable);
              break;
          }

          if (filteredResults.length === 0) {
            this.resultsContent.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            Nenhum resultado para exibir
                        </div>
                    `;
            return;
          }

          this.resultsContent.innerHTML = filteredResults
            .sort((a, b) => b.timestamp - a.timestamp)
            .map((result) => this.createResultItem(result))
            .join("");
        }

        createResultItem(result) {
          const statusClass = this.getStatusClass(result.status);
          const vulnerableFlag = result.isVulnerable ? " üö®" : "";

          return `
                    <div class="result-item">
                        <div class="status-indicator ${statusClass}"></div>
                        <div class="result-url">${result.url}${vulnerableFlag}</div>
                        <div class="result-status">${result.status}</div>
                        <div class="result-time">${result.responseTime}ms</div>
                    </div>
                `;
        }

        getStatusClass(status) {
          if (status === "ERROR") return "status-error";
          if (status >= 200 && status < 300) return "status-200";
          if (status >= 300 && status < 400) return "status-200";
          if (status === 400) return "status-400";
          if (status === 401) return "status-401";
          if (status === 403) return "status-403";
          if (status === 404) return "status-404";
          if (status >= 500) return "status-500";
          return "status-error";
        }

        updateTabsUI() {
          document.querySelectorAll(".tab-btn").forEach((btn) => {
            btn.classList.toggle("active", btn.dataset.tab === this.activeTab);
          });
        }

        stopTest() {
          this.isRunning = false;
          this.finishTest();
        }

        finishTest() {
          this.isRunning = false;
          this.updateUI();
          this.progressText.textContent = `Teste finalizado - ${this.results.length} endpoints testados`;
          this.exportBtn.disabled = this.results.length === 0;
        }

        updateUI() {
          this.startBtn.disabled = this.isRunning;
          this.stopBtn.disabled = !this.isRunning;
        }

        exportResults() {
          if (this.results.length === 0) return;

          const csv = [
            "URL,Endpoint,Status,Status Text,Response Time (ms),Vulnerable,Timestamp",
            ...this.results.map((r) =>
              [
                r.url,
                r.endpoint,
                r.status,
                `"${r.statusText}"`,
                r.responseTime,
                r.isVulnerable ? "YES" : "NO",
                r.timestamp.toISOString(),
              ].join(",")
            ),
          ].join("\n");

          const blob = new Blob([csv], { type: "text/csv" });
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = `security_test_${
            new Date().toISOString().split("T")[0]
          }.csv`;
          a.click();
          URL.revokeObjectURL(url);
        }

        sleep(ms) {
          return new Promise((resolve) => setTimeout(resolve, ms));
        }
      }

      // Inicializar aplica√ß√£o
      document.addEventListener("DOMContentLoaded", () => {
        new SecurityTester();
      });
    </script>
  </body>
</html>
